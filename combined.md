python - <<'PY'
from pathlib import Path

TEXT_EXTS = {".py", ".yml", ".yaml", ".md", ".txt", ".json", ".toml", ".ini", ".cfg"}
IMAGE_EXTS = {".png", ".jpg", ".jpeg", ".gif"}

def lang_for(p: Path) -> str:
    return {
        ".py": "python",
        ".yml": "yaml",
        ".yaml": "yaml",
        ".md": "markdown",
        ".json": "json",
        ".toml": "toml",
    }.get(p.suffix.lower(), "")

SKIP_DIRS = {".git", ".venv", "venv", "__pycache__", "node_modules"}

paths = []
for p in Path(".").rglob("*"):
    if any(part in SKIP_DIRS for part in p.parts):
        continue
    if p.is_file():
        ext = p.suffix.lower()
        if ext in TEXT_EXTS or ext in IMAGE_EXTS:
            paths.append(p)

paths = sorted(paths, key=lambda x: x.as_posix())

out = []
out.append("# Combined project files\n\n")
out.append("Generated by a script that concatenates text files and embeds images.\n\n")

for p in paths:
    rel = p.as_posix()
    ext = p.suffix.lower()

    out.append(f"\n## {rel}\n\n")

    if ext in IMAGE_EXTS:
        out.append(f"![{rel}]({rel})\n\n")
        continue

    try:
        text = p.read_text(encoding="utf-8")
    except UnicodeDecodeError:
        out.append("_Skipped (non-UTF8 or binary file)._\n\n")
        continue

    lang = lang_for(p)
    out.append(f"```{lang}\n{text}\n```\n")

Path("combined.md").write_text("".join(out), encoding="utf-8")
print(f"Wrote combined.md with {len(paths)} included items.")
PY
